# 座標系定義について(解決済)

## 概要
WirePlanetに則って、地形による座標系定義を導入しようと考えたが、欠点の方が多いと判断したので廃止する方向で行くことにした。

### WirePlanetの方法
各オブジェクトは、所属地形でのローカル座標と、空間でのグローバル座標を持っている。所属地形は、独自の座標系を持ち(円形の閉じた座標系など)、地形オブジェクトの座標変換関数によってグローバル座標を求め、それを衝突判定や描画に用いた。

### 利点
通常とは異なる座標系(惑星上など)を通常の座標系と全く同じ感覚で扱える。
　
### 欠点
ローカル座標をグローバル座標に変換するが、グローバル座標を使う衝突判定前、描画前の二回行う必要がある。  
座標の形によっては位置によってグローバル座標での移動速度か変わってしまう。惑星極座標でいうと、同じ分の座標移動でも、中心に近い場合と遠い場合では遠いほどグローバルな移動量は多くなる。  
グローバル座標とローカル座標の整合性を保つためには、変更のたびに変換しないといけない。  
地形の座標系によってはローカル座標系と表示画像の形状にずれが生じる  
地形オブジェクトが持つべき関数が多い(ローカルグローバル座標変換関数、グローバルローカル座標変換関数、座標間隔の違いによらず速度を一定にするための関数、など)

## 履歴
- 時期不明1  
地形座標は廃止するが、所属地形の概念は残す。所属地形は、座標によって下方向を示すベクトルを返す関数を持つ。これにより、惑星の重力も再現可能。
- 時期不明2  
上記方法でWirePlanetの方法を再現するのはかなりやりづらいので再導入する
- 2016/5/31以前(解決案)  
しかし、３つの座標系が存在することになり複雑になりすぎるので、親子関係は廃止してローカル座標をなくす。位置の依存関係などはコンポーネントで補う。

# 座標系優先度(解決済)

## 概要
地形座標とグローバル座標の優先度を決める必要がある。グローバル位置を変更したときに、回転度はそのままにするのか、地形座標に合わせて変えるのかなど。

## 履歴
- 2016/7/9(解決案)  
回転度はそのままにすることにした。グローバルポジションをいじるときはグローバル回転度が維持される、地形ポジションが変更されるときは地形回転度が維持されれば良い。

# 文字コードについて(暫定的解決)

## 概要
各入出力時、プログラム中の文字列リテラルの文字コードをどうするか。

## 履歴
- 2016/7/8(暫定解決)  
プログラム内(文字列リテラルなど)では基本的に環境のデフォルト文字コード(MSVCならShift-JIS)を用いる。ファイルはUTF-8BOMなし。  
文字列処理を行う場面などでは、関数でUTF-8に変換して扱ってから元に戻す。  
そのうちUTF8に統一したい。そうすればファイルと同じになるので問題が減る。ただし、プログラム中の文字列リテラルすべてにu8をつける必要がある。

# SSEやAVXを用いたベクトル処理などの高速化(暫定解決)

## 概要
SSEやAVX命令を用いてVectorや衝突判定、描画の速度を高速化する。

## 履歴
- 2016/5/31以前(暫定的解決)  
現状で速度の問題は感じられない。また、compilerの最適化でどこまで行われているのか、実際に行ってどこまで高速化できるのかがわからないし、最適化を行ったところでコストに見合うほど高速化できるかわからない。  
SSE命令などの並列度を上げるためにはdoubleではなくfloatを用いる方が良い。compilerオプションを/fp:fastにしていれば、float精度再現のオーバーヘッドは発生しない。